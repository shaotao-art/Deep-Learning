<svg viewBox="0 -0.0000019073486328125 691.1785888671875 649.8690795898438" style="max-width: 691.1785888671875px;" height="649.8690795898438" aria-labelledby="chart-title-graph-div chart-desc-graph-div" role="img" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="100%" id="graph-div"><title id="chart-title-graph-div"></title><desc id="chart-desc-graph-div"></desc><style>#graph-div {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#graph-div .error-icon{fill:#552222;}#graph-div .error-text{fill:#552222;stroke:#552222;}#graph-div .edge-thickness-normal{stroke-width:2px;}#graph-div .edge-thickness-thick{stroke-width:3.5px;}#graph-div .edge-pattern-solid{stroke-dasharray:0;}#graph-div .edge-pattern-dashed{stroke-dasharray:3;}#graph-div .edge-pattern-dotted{stroke-dasharray:2;}#graph-div .marker{fill:#333333;stroke:#333333;}#graph-div .marker.cross{stroke:#333333;}#graph-div svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#graph-div .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#graph-div .cluster-label text{fill:#333;}#graph-div .cluster-label span{color:#333;}#graph-div .label text,#graph-div span{fill:#333;color:#333;}#graph-div .node rect,#graph-div .node circle,#graph-div .node ellipse,#graph-div .node polygon,#graph-div .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#graph-div .node .label{text-align:center;}#graph-div .node.clickable{cursor:pointer;}#graph-div .arrowheadPath{fill:#333333;}#graph-div .edgePath .path{stroke:#333333;stroke-width:2.0px;}#graph-div .flowchart-link{stroke:#333333;fill:none;}#graph-div .edgeLabel{background-color:#e8e8e8;text-align:center;}#graph-div .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#graph-div .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#graph-div .cluster text{fill:#333;}#graph-div .cluster span{color:#333;}#graph-div div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#graph-div :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g style="opacity: 1;" id="L-input-query" class="edgePath LS-input LE-query"><path style="fill:none" marker-end="url(#arrowhead12194)" d="M345.29663848876953,51.98809814453125L345.29663848876953,58.153772830963135C345.29663848876953,64.31944751739502,345.29663848876953,76.65079689025879,345.29663848876953,92.64782110850017C345.29663848876953,108.64484532674153,345.29663848876953,128.3075443903605,345.29663848876953,147.9702434539795C345.29663848876953,167.63294251759848,345.29663848876953,187.29564158121744,345.29663848876953,203.29266579945883C345.29663848876953,219.2896900177002,345.29663848876953,231.62103939056396,345.29663848876953,237.78671407699585L345.29663848876953,243.95238876342773" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead12194"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs></g><g style="opacity: 1;" id="L-input-key" class="edgePath LS-input LE-key"><path style="fill:none" marker-end="url(#arrowhead12195)" d="M257.23612213134766,51.785165139962075L232.18321100870767,57.98466199382216C207.13029988606772,64.18415884768224,157.02447764078775,76.5831525554024,131.9715665181478,88.94832409569437C106.91865539550781,101.31349563598633,106.91865539550781,113.6448450088501,106.91865539550781,119.81051969528198L106.91865539550781,125.97619438171387" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead12195"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs></g><g style="opacity: 1;" id="L-input-value" class="edgePath LS-input LE-value"><path style="fill:none" marker-end="url(#arrowhead12196)" d="M433.3571548461914,51.731790071431384L458.50761858622235,57.94018277004658C483.65808232625324,64.14857546866178,533.9590098063151,76.56536086589217,559.1094735463461,92.60510309631684C584.259937286377,108.64484532674153,584.259937286377,128.3075443903605,584.259937286377,147.9702434539795C584.259937286377,167.63294251759848,584.259937286377,187.29564158121744,584.259937286377,206.95834064483643C584.259937286377,226.6210397084554,584.259937286377,246.28373877207437,584.259937286377,265.94643783569336C584.259937286377,285.6091368993123,584.259937286377,305.27183596293133,584.259937286377,324.9345350265503C584.259937286377,344.59723409016925,584.259937286377,364.25993315378827,584.259937286377,383.9226322174072C584.259937286377,403.5853312810262,584.259937286377,423.2480303446452,584.259937286377,439.24505456288654C584.259937286377,455.24207878112793,584.259937286377,467.5734281539917,584.259937286377,473.7391028404236L584.259937286377,479.90477752685547" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead12196"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs></g><g style="opacity: 1;" id="L-key-key_t" class="edgePath LS-key LE-key_t"><path style="fill:none" marker-end="url(#arrowhead12197)" d="M106.91865539550781,169.96429252624512L106.91865539550781,176.129967212677C106.91865539550781,182.2956418991089,106.91865539550781,194.62699127197266,106.91865539550781,206.95834064483643C106.91865539550781,219.2896900177002,106.91865539550781,231.62103939056396,106.91865539550781,237.78671407699585L106.91865539550781,243.95238876342773" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead12197"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs></g><g style="opacity: 1;" id="L-key_t-atten" class="edgePath LS-key_t LE-atten"><path style="fill:none" marker-end="url(#arrowhead12198)" d="M106.91865539550781,287.940486907959L106.91865539550781,294.10616159439087C106.91865539550781,300.27183628082275,106.91865539550781,312.6031856536865,119.37677123712733,324.9345350265503C131.83488707874682,337.26588439941406,156.75111876198582,349.59723377227783,169.20923460360532,355.7629084587097L181.66735044522483,361.9285831451416" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead12198"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs></g><g style="opacity: 1;" id="L-query-atten" class="edgePath LS-query LE-atten"><path style="fill:none" marker-end="url(#arrowhead12199)" d="M345.29663848876953,287.940486907959L345.29663848876953,294.10616159439087C345.29663848876953,300.27183628082275,345.29663848876953,312.6031856536865,332.83852264715,324.9345350265503C320.3804068055305,337.26588439941406,295.4641751222915,349.59723377227783,283.006059280672,355.7629084587097L270.5479434390525,361.9285831451416" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead12199"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs></g><g style="opacity: 1;" id="L-atten-atten_weight" class="edgePath LS-atten LE-atten_weight"><path style="fill:none" marker-end="url(#arrowhead12200)" d="M226.10764694213867,405.91668128967285L226.10764694213867,412.08235597610474C226.10764694213867,418.2480306625366,226.10764694213867,430.5793800354004,226.10764694213867,442.91072940826416C226.10764694213867,455.24207878112793,226.10764694213867,467.5734281539917,226.10764694213867,473.7391028404236L226.10764694213867,479.90477752685547" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead12200"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs></g><g style="opacity: 1;" id="L-atten_weight-out" class="edgePath LS-atten_weight LE-out"><path style="fill:none" marker-end="url(#arrowhead12201)" d="M226.10764694213867,523.8928756713867L226.10764694213867,530.0585503578186C226.10764694213867,536.2242250442505,226.10764694213867,548.5555744171143,239.12986066091517,560.886923789978C252.1520743796917,573.2182731628418,278.1965018172447,585.5496225357056,291.2187155360212,591.7152972221375L304.2409292547977,597.8809719085693" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead12201"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs></g><g style="opacity: 1;" id="L-value-out" class="edgePath LS-value LE-out"><path style="fill:none" marker-end="url(#arrowhead12202)" d="M584.259937286377,523.8928756713867L584.259937286377,530.0585503578186C584.259937286377,536.2242250442505,584.259937286377,548.5555744171143,559.7369537353516,560.9146214085694C535.2139701843262,573.2736684000243,486.1680030822754,585.6604130100708,461.64501953125,591.8537853150939L437.1220359802246,598.0471576201171" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead12202"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs></g></g><g class="edgeLabels"><g style="opacity: 1;" transform="translate(345.29663848876953,147.9702434539795)" class="edgeLabel"><g class="label" transform="translate(-98.91865539550781,-11.994048118591309)"><rect height="23.988096237182617" width="197.83731079101562" ry="0" rx="0"></rect><foreignObject height="23.988096237182617" width="197.83731079101562"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-input' L-LE-query" id="L-L-input-query">nn.Linear(dim_in, dim_out)</span></div></foreignObject></g></g><g style="opacity: 1;" transform="translate(106.91865539550781,88.98214626312256)" class="edgeLabel"><g class="label" transform="translate(-98.91865539550781,-11.994048118591309)"><rect height="23.988096237182617" width="197.83731079101562" ry="0" rx="0"></rect><foreignObject height="23.988096237182617" width="197.83731079101562"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-input' L-LE-key" id="L-L-input-key">nn.Linear(dim_in, dim_out)</span></div></foreignObject></g></g><g style="opacity: 1;" transform="translate(584.259937286377,265.94643783569336)" class="edgeLabel"><g class="label" transform="translate(-98.91865539550781,-11.994048118591309)"><rect height="23.988096237182617" width="197.83731079101562" ry="0" rx="0"></rect><foreignObject height="23.988096237182617" width="197.83731079101562"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-input' L-LE-value" id="L-L-input-value">nn.Linear(dim_in, dim_out)</span></div></foreignObject></g></g><g style="opacity: 1;" transform="translate(106.91865539550781,206.95834064483643)" class="edgeLabel"><g class="label" transform="translate(-34.449405670166016,-11.994048118591309)"><rect height="23.988096237182617" width="68.89881134033203" ry="0" rx="0"></rect><foreignObject height="23.988096237182617" width="68.89881134033203"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-key' L-LE-key_t" id="L-L-key-key_t">transpose</span></div></foreignObject></g></g><g style="opacity: 1;" transform="translate(106.91865539550781,324.9345350265503)" class="edgeLabel"><g class="label" transform="translate(-17.74305534362793,-11.994048118591309)"><rect height="23.988096237182617" width="35.48611068725586" ry="0" rx="0"></rect><foreignObject height="23.988096237182617" width="35.48611068725586"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-key_t' L-LE-atten" id="L-L-key_t-atten">bmm</span></div></foreignObject></g></g><g style="opacity: 1;" transform="translate(345.29663848876953,324.9345350265503)" class="edgeLabel"><g class="label" transform="translate(-17.74305534362793,-11.994048118591309)"><rect height="23.988096237182617" width="35.48611068725586" ry="0" rx="0"></rect><foreignObject height="23.988096237182617" width="35.48611068725586"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-query' L-LE-atten" id="L-L-query-atten">bmm</span></div></foreignObject></g></g><g style="opacity: 1;" transform="translate(226.10764694213867,442.91072940826416)" class="edgeLabel"><g class="label" transform="translate(-53.80952453613281,-11.994048118591309)"><rect height="23.988096237182617" width="107.61904907226562" ry="0" rx="0"></rect><foreignObject height="23.988096237182617" width="107.61904907226562"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-atten' L-LE-atten_weight" id="L-L-atten-atten_weight">nn.Softmax(-1)</span></div></foreignObject></g></g><g style="opacity: 1;" transform="translate(226.10764694213867,560.886923789978)" class="edgeLabel"><g class="label" transform="translate(-17.74305534362793,-11.994048118591309)"><rect height="23.988096237182617" width="35.48611068725586" ry="0" rx="0"></rect><foreignObject height="23.988096237182617" width="35.48611068725586"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-atten_weight' L-LE-out" id="L-L-atten_weight-out">bmm</span></div></foreignObject></g></g><g style="opacity: 1;" transform="translate(584.259937286377,560.886923789978)" class="edgeLabel"><g class="label" transform="translate(-17.74305534362793,-11.994048118591309)"><rect height="23.988096237182617" width="35.48611068725586" ry="0" rx="0"></rect><foreignObject height="23.988096237182617" width="35.48611068725586"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-value' L-LE-out" id="L-L-value-out">bmm</span></div></foreignObject></g></g></g><g class="nodes"><g style="opacity: 1;" transform="translate(345.29663848876953,29.994049072265625)" id="flowchart-input-14370" class="node default"><rect class="label-container" height="43.98809623718262" width="176.12103271484375" y="-21.99404811859131" x="-88.06051635742188" ry="5" rx="5"></rect><g transform="translate(0,0)" class="label"><g transform="translate(-78.06051635742188,-11.994048118591309)"><foreignObject height="23.988096237182617" width="156.12103271484375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml">input [N, len, dim_in]</div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(345.29663848876953,265.94643783569336)" id="flowchart-query-14371" class="node default"><rect class="label-container" height="43.98809623718262" width="189.67262268066406" y="-21.99404811859131" x="-94.83631134033203" ry="5" rx="5"></rect><g transform="translate(0,0)" class="label"><g transform="translate(-84.83631134033203,-11.994048118591309)"><foreignObject height="23.988096237182617" width="169.67262268066406"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml">query [N, len, dim_out]</div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(106.91865539550781,147.9702434539795)" id="flowchart-key-14373" class="node default"><rect class="label-container" height="43.98809623718262" width="173.86904907226562" y="-21.99404811859131" x="-86.93452453613281" ry="5" rx="5"></rect><g transform="translate(0,0)" class="label"><g transform="translate(-76.93452453613281,-11.994048118591309)"><foreignObject height="23.988096237182617" width="153.86904907226562"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml">key [N, len, dim_out]</div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(584.259937286377,501.8988265991211)" id="flowchart-value-14375" class="node default"><rect class="label-container" height="43.98809623718262" width="187.61904907226562" y="-21.99404811859131" x="-93.80952453613281" ry="5" rx="5"></rect><g transform="translate(0,0)" class="label"><g transform="translate(-83.80952453613281,-11.994048118591309)"><foreignObject height="23.988096237182617" width="167.61904907226562"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml">value [N, len, dim_out]</div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(106.91865539550781,265.94643783569336)" id="flowchart-key_t-14377" class="node default"><rect class="label-container" height="43.98809623718262" width="187.08334350585938" y="-21.99404811859131" x="-93.54167175292969" ry="5" rx="5"></rect><g transform="translate(0,0)" class="label"><g transform="translate(-83.54167175292969,-11.994048118591309)"><foreignObject height="23.988096237182617" width="167.08334350585938"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml">key.T [N, dim_out, len]</div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(226.10764694213867,383.9226322174072)" id="flowchart-atten-14379" class="node default"><rect class="label-container" height="43.98809623718262" width="151.11111450195312" y="-21.99404811859131" x="-75.55555725097656" ry="5" rx="5"></rect><g transform="translate(0,0)" class="label"><g transform="translate(-65.55555725097656,-11.994048118591309)"><foreignObject height="23.988096237182617" width="131.11111450195312"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml">atten [N, len, len]</div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(226.10764694213867,501.8988265991211)" id="flowchart-atten_weight-14383" class="node default"><rect class="label-container" height="43.98809623718262" width="210.72421264648438" y="-21.99404811859131" x="-105.36210632324219" ry="5" rx="5"></rect><g transform="translate(0,0)" class="label"><g transform="translate(-95.36210632324219,-11.994048118591309)"><foreignObject height="23.988096237182617" width="190.72421264648438"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml">atten weights [N, len, len]</div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(350.6934623718262,619.875020980835)" id="flowchart-out-14385" class="node default"><rect class="label-container" height="43.98809623718262" width="172.85714721679688" y="-21.99404811859131" x="-86.42857360839844" ry="5" rx="5"></rect><g transform="translate(0,0)" class="label"><g transform="translate(-76.42857360839844,-11.994048118591309)"><foreignObject height="23.988096237182617" width="152.85714721679688"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml">out [N, len, dim_out]</div></foreignObject></g></g></g></g></g></g></svg>